\documentclass[]{article}
\usepackage[oldstyle,sups]{fbb}% to use free Bembo font (old style numbers)
\usepackage[margin=.75in]{geometry}
\pagestyle{empty}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{textcomp} % provide euro and other symbols
\usepackage{fontawesome}
\usepackage{menukeys}
\usepackage{tikz}
\usetikzlibrary{calc,math,shapes}

% Manually define visible space (which otherwise doesn't appear in fbb font)
\newsavebox{\textvisiblespacebox}
\savebox{\textvisiblespacebox}{M}
\newcommand\vtextvisiblespace[1][\wd\textvisiblespacebox]{%
  \makebox[#1]{\kern.1em\rule{.4pt}{.3ex}%
  \hrulefill%
  \rule{.4pt}{.3ex}\kern.1em}%
}

\begin{document}

% Text on keycaps
\pgfkeys{
%
% DVORAK LAYER
%
    /Left/dvorak/4/2/.code=\textquotedbl\\\textquotesingle,
        /Left/dvorak/3/2/.code=<\\{,},
        /Left/dvorak/2/2/.code=>\\.,
        /Left/dvorak/1/2/.code=P,
        /Left/dvorak/0/2/.code=Y,
    /Left/dvorak/4/1/.code=A,
        /Left/dvorak/3/1/.code=O,
        /Left/dvorak/2/1/.code=E,
        /Left/dvorak/1/1/.code=U,
        /Left/dvorak/0/1/.code=I,
    /Left/dvorak/4/0/.code=:~~;\\\shift,
        /Left/dvorak/3/0/.code=Q\\\ctrl,
        /Left/dvorak/2/0/.code=J\\\Alt,
        /Left/dvorak/1/0/.code=K\\\cmd,
        /Left/dvorak/0/0/.code=X,
    /Left/dvorak/6/0/.code=,
        /Left/dvorak/6/1/.code=\backdel\\\textsc{num},
%
    /Right/dvorak/0/2/.code=F,
        /Right/dvorak/1/2/.code=G,
        /Right/dvorak/2/2/.code=C,
        /Right/dvorak/3/2/.code=R,
        /Right/dvorak/4/2/.code=L,
    /Right/dvorak/0/1/.code=D,
        /Right/dvorak/1/1/.code=H,
        /Right/dvorak/2/1/.code=T,
        /Right/dvorak/3/1/.code=N,
        /Right/dvorak/4/1/.code=S,
    /Right/dvorak/0/0/.code=B,
        /Right/dvorak/1/0/.code=M\\\cmd,
        /Right/dvorak/2/0/.code=W\\\Alt,
        /Right/dvorak/3/0/.code=V\\\ctrl,
        /Right/dvorak/4/0/.code=Z\\\shift,
    /Right/dvorak/6/0/.code=\return\\\textsc{gui},
        /Right/dvorak/6/1/.code=\phantom{M}\vtextvisiblespace\phantom{M}\\\textsc{fun},
%
% NUMBER LAYER
%
    /Left/number/4/2/.code=\tab,
        /Left/number/3/2/.code=\&,
        /Left/number/2/2/.code=*,
        /Left/number/1/2/.code=ยง,
        /Left/number/0/2/.code=,
    /Left/number/4/1/.code=\textsc{num}\\\textsc{lock},
        /Left/number/3/1/.code=\$,
        /Left/number/2/1/.code=\%,
        /Left/number/1/1/.code=\textasciicircum,
        /Left/number/0/1/.code=,
    /Left/number/4/0/.code=\shift,
        /Left/number/3/0/.code=!,
        /Left/number/2/0/.code=@,
        /Left/number/1/0/.code=\#,
        /Left/number/0/0/.code=$^{\circ}$,
    /Left/number/6/0/.code=,
        /Left/number/6/1/.code=\textsc{trns},
%
    /Right/number/0/2/.code=,
        /Right/number/1/2/.code=7,
        /Right/number/2/2/.code=8,
        /Right/number/3/2/.code=9,
        /Right/number/4/2/.code=+\\{=},
    /Right/number/0/1/.code=:,
        /Right/number/1/1/.code=4,
        /Right/number/2/1/.code=5,
        /Right/number/3/1/.code=6,
        /Right/number/4/1/.code=\_\\-,
    /Right/number/0/0/.code=0,
        /Right/number/1/0/.code=1,
        /Right/number/2/0/.code=2,
        /Right/number/3/0/.code=3,
        /Right/number/4/0/.code=\textasciitilde\\`,
    /Right/number/6/0/.code=|\\\textbackslash,
        /Right/number/6/1/.code=\textsc{trns},
%
% FUNCTION LAYER
%
    /Left/function/4/2/.code=\textsc{reset},
        /Left/function/3/2/.code=F7,
        /Left/function/2/2/.code=F8,
        /Left/function/1/2/.code=F9,
        /Left/function/0/2/.code=F12,
    /Left/function/4/1/.code=\textsc{func}\\\textsc{lock},
        /Left/function/3/1/.code=F4,
        /Left/function/2/1/.code=F5,
        /Left/function/1/1/.code=F6,
        /Left/function/0/1/.code=F11,
    /Left/function/4/0/.code=\shift,
        /Left/function/3/0/.code=F1\\\ctrl,
        /Left/function/2/0/.code=F2\\\Alt,
        /Left/function/1/0/.code=F3\\\cmd,
        /Left/function/0/0/.code=F10,
    /Left/function/6/0/.code=,
        /Left/function/6/1/.code=\textsc{trns},
%
    /Right/function/0/2/.code=\faVolumeUp,
        /Right/function/1/2/.code=Home,
        /Right/function/2/2/.code=\arrowkeyup,
        /Right/function/3/2/.code=PgUp,
        /Right/function/4/2/.code=\faSunO,
    /Right/function/0/1/.code=\faVolumeDown,
        /Right/function/1/1/.code=\arrowkeyleft,
        /Right/function/2/1/.code=\arrowkeydown,
        /Right/function/3/1/.code=\arrowkeyright,
        /Right/function/4/1/.code=\faCircleThin,
    /Right/function/0/0/.code=\faVolumeOff,
        /Right/function/1/0/.code=End,
        /Right/function/2/0/.code=,
        /Right/function/3/0/.code=PgDn,
        /Right/function/4/0/.code=\capslock,
    /Right/function/6/0/.code=\textsc{trns},
        /Right/function/6/1/.code=\textsc{trns},
%
% GUI/MISC LAYER
%
    /Left/gui/4/2/.code=\faBluetoothB{} / \faUsb\\toggle,
        /Left/gui/3/2/.code=,
        /Left/gui/2/2/.code=Mouse\\\arrowkeyup,
        /Left/gui/1/2/.code=Wheel\\\arrowkeyup,
        /Left/gui/0/2/.code=Accel\\2,
    /Left/gui/4/1/.code=,
        /Left/gui/3/1/.code=Mouse\\\arrowkeyleft,
        /Left/gui/2/1/.code=Mouse\\\arrowkeydown,
        /Left/gui/1/1/.code=Mouse\\\arrowkeyright,
        /Left/gui/0/1/.code=Accel\\1,
    /Left/gui/4/0/.code=\shift,
        /Left/gui/3/0/.code=\ctrl,
        /Left/gui/2/0/.code=,
        /Left/gui/1/0/.code=Wheel\\\arrowkeydown,
        /Left/gui/0/0/.code=Accel\\0,
    /Left/gui/6/0/.code=,
        /Left/gui/6/1/.code=Left\\Button,
%
    /Right/gui/0/2/.code=,
        /Right/gui/1/2/.code=Prev\\Win,
        /Right/gui/2/2/.code=Win\\Big,
        /Right/gui/3/2/.code=Next\\Win,
        /Right/gui/4/2/.code=\faBluetoothB~1,
    /Right/gui/0/1/.code=,
        /Right/gui/1/1/.code=Win\\1/3 L,
        /Right/gui/2/1/.code=Win\\Small,
        /Right/gui/3/1/.code=Win\\1/3 R,
        /Right/gui/4/1/.code=\faBluetoothB~2,
    /Right/gui/0/0/.code=,
        /Right/gui/1/0/.code=Win\\Left,
        /Right/gui/2/0/.code=Win\\Center,
        /Right/gui/3/0/.code=Win\\Right,
        /Right/gui/4/0/.code=\faBluetoothB~3,
    /Right/gui/6/0/.code=\textsc{trns},
        /Right/gui/6/1/.code=Right\\Button,
}

\foreach \keyboard / \layer in {dvorak/0, number/1, function/2, gui/3}
{

\begin{centering}

\resizebox{6.33in}{!}{%  Make this `\textwidth` for portrait; `9in` for landscape.

\begin{tikzpicture}[
    rectStyle/.style={inner sep=0pt,minimum size=\keySizeVert in,draw,font=\Large,align=center},
    vcomboStyle/.style={minimum width=\keySizeHoriz, align=center, font=\Large},
    hcomboStyle/.style={minimum width=\keySepHoriz, align=center, font=\Large},
    ]

    % VARIABLES. DISTANCES ARE IN INCHES
    \tikzmath{
        \rotAngle      = 0;
        \separation    = 1.0;
        \keySizeHoriz  = .55;
        \keySizeVert   = .55;
        \keySepHoriz   = .2;
        \keySepVert    = .2;
        \keySpaceHoriz = \keySizeHoriz + \keySepHoriz;
        \keySpaceVert  = \keySizeVert + \keySepVert;
        \yoffset{0}    = 0;
        \yoffset{1}    = 0;
        \yoffset{2}    = 0;
        \yoffset{3}    = 0;
        \yoffset{4}    = 0;
        % \rounding    = \keySepVert;
        % \margin      = .13;
    }

    % DEFINE PLACEMENT
    \coordinate (LEFT) at (-\separation in, 0in);
    \coordinate (LeftROT) at ($(LEFT) + (\keySizeHoriz*.5 in,-\keySizeVert*.5 in)$);
    \coordinate (RIGHT) at (\separation in, 0in);
    \coordinate (RightROT) at ($(RIGHT) + (-\keySizeHoriz*.5 in,-\keySizeVert*.5 in)$);

    % MAIN KEY GRID
    \foreach \x in {0,1,2,3,4}
    {
        \foreach \y in {0,1,2}
        {
            \node [rectStyle,rotate around={-\rotAngle:(LeftROT)}] (left-\x-\y)
                at ($(LEFT) + (-\keySpaceHoriz*\x in,\yoffset{\x}in + \keySpaceVert*\y in)$)
                {\pgfkeys{Left/\keyboard/\x/\y}};

            \node [rectStyle, rotate around={\rotAngle:(RightROT)}] (right-\x-\y)
                at ($(RIGHT) + (\keySpaceHoriz*\x in,\yoffset{\x}in + \keySpaceVert*\y in)$)
                {\pgfkeys{Right/\keyboard/\x/\y}};
        }
    }

    % LEFT THUMB KEY
    \ifthenelse{\layer = 1}{% Highlight on layer 1, not otherwise
        \node [fill=black!7,rectStyle, rotate=0, rotate around={-\rotAngle:(LeftROT)}] (left-t-1)
            at ($(LEFT) + (\keySpaceHoriz*.5 in,-\keySpaceVert in)$) {\pgfkeys{Left/\keyboard/6/1}};
        }{
        \node [rectStyle, rotate=0, rotate around={-\rotAngle:(LeftROT)}] (left-t-1)
            at ($(LEFT) + (\keySpaceHoriz*.5 in,-\keySpaceVert in)$) {\pgfkeys{Left/\keyboard/6/1}};
        }
    % RIGHT THUMB KEYS
    \ifthenelse{\layer = 2}{% Highlight on layer 2, not otherwise
        \node [fill=black!7,rectStyle, rotate=0, rotate around={\rotAngle:(RightROT)}] (right-t-1)
            at ($(RIGHT) + (-\keySpaceHoriz*.5 in,-\keySpaceVert in)$) {\pgfkeys{Right/\keyboard/6/1}};
        }{
        \node [rectStyle, rotate=0, rotate around={\rotAngle:(RightROT)}] (right-t-1)
            at ($(RIGHT) + (-\keySpaceHoriz*.5 in,-\keySpaceVert in)$) {\pgfkeys{Right/\keyboard/6/1}};
        }
    \ifthenelse{\layer = 3}{% Highlight on layer 3, not otherwise
        \node [fill=black!7,rectStyle, rotate around={\rotAngle:(RightROT)}] (right-t-0)
            at ($(RIGHT) + (\keySpaceHoriz*.5 in,-\keySpaceVert in)$) {\pgfkeys{Right/\keyboard/6/0}};
        }{
        \node [rectStyle, rotate around={\rotAngle:(RightROT)}] (right-t-0)
            at ($(RIGHT) + (\keySpaceHoriz*.5 in,-\keySpaceVert in)$) {\pgfkeys{Right/\keyboard/6/0}};
        }

    % DIVIDE KEYS WITH TAPPED/HELD PARTS
        % \key is the key location
        % \x is the layer the key is on
    \foreach \key / \x in
        {
            left-4-0/0  , left-3-0/0  , left-2-0/0  , left-1-0/0  ,
            right-4-0/0 , right-3-0/0 , right-2-0/0 , right-1-0/0 ,
            left-t-1/0  ,
            right-t-0/0 , right-t-1/0 ,
            left-3-0/2  , left-2-0/2  , left-1-0/2
        }
        {
            \ifthenelse { \layer=\x }
            {
                \draw [color=gray] (\key.west) -- (\key.east);
            }{}
        }

    % COMBOS
        % `\key` is the key location
        % `\direction` is either `\west` (left) or `\south` (below) the key
        % `\legend` is what to put there
        % `\x` is the layer
    \foreach \key / \direction / \legend / \x in
        {
            left-4-2/south/\faBluetoothB{}Clear/3,
            left-3-2/west/\tab/0,
            left-3-2/south/"/0,
            left-3-1/west/"/0,
            left-2-2/west/\esc/2,
            left-2-2/west/\esc/1,
            left-2-2/west/\esc/0,
            left-2-1/west/?/0,
            left-1-2/west/\{\\{[}/0,
            left-1-2/south/\textasciigrave{}~~\textasciitilde/0,
            left-2-2/south/!/0,
            left-1-1/west/(/0,
            right-4-2/west/\backdel/1,
            right-4-2/west/\backdel/0,
            right-4-1/west/\return/3,
            right-4-1/west/\return/2,
            right-4-1/west/\return/1,
            right-4-1/west/\return/0,
            right-3-2/south/\return/3,
            right-3-2/south/\return/2,
            right-3-2/south/\return/1,
            right-3-2/south/\return/0,
            right-3-1/west/?\\{/}/0,
            right-3-0/west/./1,
            right-2-2/west/\}\\{]}/0,
            right-2-2/south/=~~+/0,
            right-2-2/south/=~~+/1,
            right-2-1/west/)/0,
            right-2-0/west/0/1,
            right-1-2/south/-~~\_/0,
            right-1-2/south/-~~\_/1
        }
        {
            \ifthenelse { \layer=\x }
            {
                \ifthenelse {\equal{\direction}{south}}
                {% combos between keys arranged vertically
                    \node [vcomboStyle] at ($(\key.\direction) - (0,1.25*\keySepVert)$) {\legend};
                }
                {% combos between keys arranged horizontally
                    \node [hcomboStyle] at ($(\key.\direction) - (1.25*\keySepHoriz,0)$)
                        {\vspace{-1.25\baselineskip}\legend};
                }
            }{}
        }

    % % DISPLAY KEY
    % \ifthenelse{\layer = 2 \OR \layer = 4}{
    % \node [rectStyle,rectangle split,rectangle split parts=2,inner ysep=.072in,color=gray]
    %     at (-5in, -1.4in) {\emph{tapped} \nodepart{second} \emph{held}};
    % }{}

    % IDENTIFY LAYER
    \node at (0,3.8) {\huge\textsc{\keyboard}};

\end{tikzpicture}

} % resize box

\vspace{.4in}

\end{centering}

} % foreach

\end{document}
